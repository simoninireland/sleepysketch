<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC '-//W3C//DTD SVG 1.0//EN'
          'http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd'>
<svg fill-opacity="1" xmlns:xlink="http://www.w3.org/1999/xlink" color-rendering="auto" color-interpolation="auto" stroke="black" text-rendering="auto" stroke-linecap="square" width="1320" stroke-miterlimit="10" stroke-opacity="1" shape-rendering="auto" fill="black" stroke-dasharray="none" font-weight="normal" stroke-width="1" viewBox="-20 -20 1320 810" height="810" xmlns="http://www.w3.org/2000/svg" font-family="&apos;Dialog&apos;" font-style="normal" stroke-linejoin="miter" font-size="12" stroke-dashoffset="0" image-rendering="auto"
><!--Generated by the Batik Graphics2D SVG Generator--><defs id="genericDefs"
  /><g
  ><g fill="white" font-size="14" font-family="sans-serif" transform="translate(390,0)" stroke="white"
    ><rect x="0" width="439" height="229" y="0" opacity="0" stroke="none"
      /><rect fill="none" x="0" width="439" height="229" y="0" stroke="black"
      /><text fill="black" x="181" xml:space="preserve" y="17" stroke="none"
      >«singleton»</text
      ><text fill="black" x="174" xml:space="preserve" y="34" stroke="none"
      >SleepySketch</text
      ><line y2="37" fill="none" x1="0" x2="439" stroke="black" y1="37"
      /><line y2="40" fill="none" x1="0" x2="439" stroke="black" y1="40"
      /><text fill="black" x="7" xml:space="preserve" y="57" stroke="none"
      >SleepySketch()</text
      ><text fill="black" x="7" xml:space="preserve" y="74" stroke="none"
      >+begin( s : Sleeper, maxActors : int )</text
      ><text fill="black" x="7" xml:space="preserve" y="91" stroke="none"
      >+now() : long</text
      ><text fill="black" x="7" xml:space="preserve" y="108" stroke="none"
      >+loop()</text
      ><text fill="black" x="7" xml:space="preserve" y="125" stroke="none"
      >+expandTime( day : int, hour : int, min : int, sec : int ) : long </text
      ><text fill="black" x="7" xml:space="preserve" y="142" stroke="none"
      >+scheduleIn( a : Actor, millis : long )</text
      ><text fill="black" x="7" xml:space="preserve" y="159" stroke="none"
      >+scheduleEvery( a : Actor, millis : long )</text
      ><line y2="162" fill="none" x1="0" x2="439" stroke="black" y1="162"
      /><text fill="black" x="7" xml:space="preserve" y="179" stroke="none"
      >Responsibilities</text
      ><text fill="black" x="7" xml:space="preserve" y="196" stroke="none"
      >-- Manage events in order</text
      ><text fill="black" x="7" xml:space="preserve" y="213" stroke="none"
      >-- Request sleeps as needed</text
      ><rect x="0" y="0" transform="translate(560,0)" width="289" height="119" opacity="0" stroke="none"
      /><rect x="0" y="0" transform="translate(560,0)" fill="none" width="289" height="119" stroke="black"
      /><text fill="black" x="109" xml:space="preserve" y="17" transform="translate(560,0)" stroke="none"
      >«abstract»</text
      ><text fill="black" x="119" xml:space="preserve" y="34" transform="translate(560,0)" stroke="none"
      >Sleeper</text
      ><line transform="translate(560,0)" fill="none" x1="0" x2="289" y1="37" y2="37" stroke="black"
      /><line transform="translate(560,0)" fill="none" x1="0" x2="289" y1="40" y2="40" stroke="black"
      /><text x="7" y="57" transform="translate(560,0)" fill="black" font-style="italic" stroke="none" xml:space="preserve"
      >+sleepFor( millis: long ) : long</text
      ><text x="7" y="74" transform="translate(560,0)" fill="black" font-style="italic" stroke="none" xml:space="preserve"
      >+now() : long</text
      ><line transform="translate(560,0)" fill="none" x1="0" x2="289" y1="77" y2="77" stroke="black"
      /><text fill="black" x="7" xml:space="preserve" y="94" transform="translate(560,0)" stroke="none"
      >Responsibilities</text
      ><text fill="black" x="7" xml:space="preserve" y="111" transform="translate(560,0)" stroke="none"
      >-- Sleep in the most efficient manner</text
      ><rect x="0" y="0" transform="translate(490,460)" width="399" height="139" opacity="0" stroke="none"
      /><rect x="0" y="0" transform="translate(490,460)" fill="none" width="399" height="139" stroke="black"
      /><text fill="black" x="152" xml:space="preserve" y="17" transform="translate(490,460)" stroke="none"
      >HeavySleeper</text
      ><line transform="translate(490,460)" fill="none" x1="0" x2="399" y1="20" y2="20" stroke="black"
      /><text fill="black" x="7" xml:space="preserve" y="37" transform="translate(490,460)" stroke="none"
      >-wakeUpOffset : long</text
      ><line transform="translate(490,460)" fill="none" x1="0" x2="399" y1="40" y2="40" stroke="black"
      /><text fill="black" x="7" xml:space="preserve" y="57" transform="translate(490,460)" stroke="none"
      >+sleepFor( millis: long ) : long</text
      ><text fill="black" x="7" xml:space="preserve" y="74" transform="translate(490,460)" stroke="none"
      >+now() : long</text
      ><line transform="translate(490,460)" fill="none" x1="0" x2="399" y1="77" y2="77" stroke="black"
      /><text fill="black" x="7" xml:space="preserve" y="94" transform="translate(490,460)" stroke="none"
      >Responsibilities</text
      ><text fill="black" x="7" xml:space="preserve" y="111" transform="translate(490,460)" stroke="none"
      >-- Sleep using watchdog timer as long as possible</text
      ><text fill="black" x="7" xml:space="preserve" y="128" transform="translate(490,460)" stroke="none"
      >-- Keep track of time spent asleep, for correcting time</text
      ><line transform="translate(750,90)" fill="none" x1="30" x2="30" y1="30" y2="200" stroke="black"
      /><line transform="translate(750,90)" fill="none" x1="30" x2="30" y1="200" y2="370" stroke="black"
      /><line transform="translate(750,90)" fill="none" x1="30" x2="36" y1="30" y2="42" stroke="black"
      /><line transform="translate(750,90)" fill="none" x1="30" x2="24" y1="30" y2="42" stroke="black"
      /><polygon points=" 30 30 36 42 24 42" transform="translate(750,90)" stroke="none"
      /><polygon fill="none" transform="translate(750,90)" points=" 30 30 36 42 24 42" stroke="black"
      /><rect x="0" y="0" transform="translate(-20,360)" width="299" height="169" opacity="0" stroke="none"
      /><rect x="0" y="0" transform="translate(-20,360)" fill="none" width="299" height="169" stroke="black"
      /><text fill="black" x="114" xml:space="preserve" y="17" transform="translate(-20,360)" stroke="none"
      >«abstract»</text
      ><text fill="black" x="132" xml:space="preserve" y="34" transform="translate(-20,360)" stroke="none"
      >Actor</text
      ><line transform="translate(-20,360)" fill="none" x1="0" x2="299" y1="37" y2="37" stroke="black"
      /><line transform="translate(-20,360)" fill="none" x1="0" x2="299" y1="40" y2="40" stroke="black"
      /><text x="7" y="57" transform="translate(-20,360)" fill="black" font-style="italic" stroke="none" xml:space="preserve"
      >pre()</text
      ><text x="7" y="74" transform="translate(-20,360)" fill="black" font-style="italic" stroke="none" xml:space="preserve"
      >post()</text
      ><text x="7" y="91" transform="translate(-20,360)" fill="black" font-style="italic" stroke="none" xml:space="preserve"
      >behaviour()</text
      ><text fill="black" x="7" xml:space="preserve" y="108" transform="translate(-20,360)" stroke="none"
      >+execute()</text
      ><line transform="translate(-20,360)" fill="none" x1="0" x2="299" y1="111" y2="111" stroke="black"
      /><text fill="black" x="7" xml:space="preserve" y="128" transform="translate(-20,360)" stroke="none"
      >Responsibilities</text
      ><text fill="black" x="7" xml:space="preserve" y="145" transform="translate(-20,360)" stroke="none"
      >-- Execute time-limited behaviour</text
      ><text fill="black" x="7" xml:space="preserve" y="162" transform="translate(-20,360)" stroke="none"
      >-- Provide pre- and post-behaviour hooks</text
      ><rect x="0" y="0" transform="translate(440,270)" width="289" height="149" opacity="0" stroke="none"
      /><rect x="0" y="0" transform="translate(440,270)" fill="none" width="289" height="149" stroke="black"
      /><text fill="black" x="103" xml:space="preserve" y="17" transform="translate(440,270)" stroke="none"
      >BusySleeper</text
      ><line transform="translate(440,270)" fill="none" x1="0" x2="289" y1="20" y2="20" stroke="black"
      /><line transform="translate(440,270)" fill="none" x1="0" x2="289" y1="23" y2="23" stroke="black"
      /><text fill="black" x="7" xml:space="preserve" y="40" transform="translate(440,270)" stroke="none"
      >+sleepFor( millis: long ) : long</text
      ><text fill="black" x="7" xml:space="preserve" y="57" transform="translate(440,270)" stroke="none"
      >+now() : long</text
      ><line transform="translate(440,270)" fill="none" x1="0" x2="289" y1="60" y2="60" stroke="black"
      /><text fill="black" x="7" xml:space="preserve" y="77" transform="translate(440,270)" stroke="none"
      >Responsibilities</text
      ><text fill="black" x="7" xml:space="preserve" y="94" transform="translate(440,270)" stroke="none"
      >-- Sleep using normal delay() function</text
      ><text fill="black" x="7" xml:space="preserve" y="111" transform="translate(440,270)" stroke="none"
      >-- Doesn't save any power</text
      ><text fill="black" x="7" xml:space="preserve" y="128" transform="translate(440,270)" stroke="none"
      >-- Useful for debugging</text
      ><line transform="translate(560,90)" fill="none" x1="30" x2="30" y1="30" y2="105" stroke="black"
      /><line transform="translate(560,90)" fill="none" x1="30" x2="30" y1="105" y2="180" stroke="black"
      /><line transform="translate(560,90)" fill="none" x1="30" x2="36" y1="30" y2="42" stroke="black"
      /><line transform="translate(560,90)" fill="none" x1="30" x2="24" y1="30" y2="42" stroke="black"
      /><polygon points=" 30 30 36 42 24 42" transform="translate(560,90)" stroke="none"
      /><polygon fill="none" transform="translate(560,90)" points=" 30 30 36 42 24 42" stroke="black"
      /><line transform="translate(410,20)" fill="none" x1="30" x2="90" y1="30" y2="30" stroke="black"
      /><line transform="translate(410,20)" fill="none" x1="90" x2="150" y1="30" y2="30" stroke="black"
      /><line transform="translate(410,20)" fill="none" x1="30" x2="42" y1="30" y2="24" stroke="black"
      /><line transform="translate(410,20)" fill="none" x1="30" x2="42" y1="30" y2="36" stroke="black"
      /><polygon fill="black" transform="translate(410,20)" points=" 30 30 42 24 54 30 42 36" stroke="none"
      /><line transform="translate(80,200)" fill="none" x1="30" x2="30" y1="30" y2="95" stroke="black"
      /><line transform="translate(80,200)" fill="none" x1="30" x2="30" y1="95" y2="160" stroke="black"
      /><line transform="translate(80,200)" fill="none" x1="30" x2="36" y1="30" y2="42" stroke="black"
      /><line transform="translate(80,200)" fill="none" x1="30" x2="24" y1="30" y2="42" stroke="black"
      /><polygon points=" 30 30 36 42 30 54 24 42" transform="translate(80,200)" stroke="none"
      /><polygon fill="none" transform="translate(80,200)" points=" 30 30 36 42 30 54 24 42" stroke="black"
      /><rect x="0" y="0" transform="translate(-360,10)" width="209" height="89" opacity="0" stroke="none"
      /><rect x="0" y="0" transform="translate(-360,10)" fill="none" width="209" height="89" stroke="black"
      /><text fill="black" x="55" xml:space="preserve" y="17" transform="translate(-360,10)" stroke="none"
      >ActorSchedule</text
      ><line transform="translate(-360,10)" fill="none" x1="0" x2="209" y1="20" y2="20" stroke="black"
      /><text fill="black" x="7" xml:space="preserve" y="37" transform="translate(-360,10)" stroke="none"
      >+actor : Actor</text
      ><text fill="black" x="7" xml:space="preserve" y="54" transform="translate(-360,10)" stroke="none"
      >+scheduledTime : long</text
      ><text fill="black" x="7" xml:space="preserve" y="71" transform="translate(-360,10)" stroke="none"
      >+next : ActorSchedule</text
      ><line transform="translate(-180,0)" fill="none" x1="180" x2="105" y1="50" y2="50" stroke="black"
      /><line transform="translate(-180,0)" fill="none" x1="105" x2="30" y1="50" y2="50" stroke="black"
      /><line transform="translate(-180,0)" fill="none" x1="179" x2="167" y1="50" y2="56" stroke="black"
      /><line transform="translate(-180,0)" fill="none" x1="179" x2="167" y1="50" y2="44" stroke="black"
      /><polygon points=" 179 50 167 56 155 50 167 44" transform="translate(-180,0)" stroke="none"
      /><polygon fill="none" transform="translate(-180,0)" points=" 179 50 167 56 155 50 167 44" stroke="black"
      /><text fill="black" x="84" xml:space="preserve" y="47" transform="translate(-180,0)" stroke="none"
      >queue</text
      ><line transform="translate(-180,40)" fill="none" x1="180" x2="105" y1="50" y2="50" stroke="black"
      /><line transform="translate(-180,40)" fill="none" x1="105" x2="30" y1="50" y2="50" stroke="black"
      /><line transform="translate(-180,40)" fill="none" x1="179" x2="167" y1="50" y2="56" stroke="black"
      /><line transform="translate(-180,40)" fill="none" x1="179" x2="167" y1="50" y2="44" stroke="black"
      /><polygon points=" 179 50 167 56 155 50 167 44" transform="translate(-180,40)" stroke="none"
      /><polygon fill="none" transform="translate(-180,40)" points=" 179 50 167 56 155 50 167 44" stroke="black"
      /><text fill="black" x="69" xml:space="preserve" y="47" transform="translate(-180,40)" stroke="none"
      >freeQueue</text
      ><polygon fill="blue" transform="translate(-390,190)" opacity="0.5" points=" 0 0 186 0 186 0 199 14 199 14 199 79 199 79 0 79 0 79 0 0" stroke="none"
      /><text fill="black" x="7" xml:space="preserve" y="17" transform="translate(-390,190)" stroke="none"
      >Allocated statically. Each</text
      ><text fill="black" x="7" xml:space="preserve" y="34" transform="translate(-390,190)" stroke="none"
      >schedule linked to either</text
      ><text fill="black" x="7" xml:space="preserve" y="51" transform="translate(-390,190)" stroke="none"
      >the schedule or free</text
      ><text fill="black" x="7" xml:space="preserve" y="68" transform="translate(-390,190)" stroke="none"
      >queue</text
      ><line transform="translate(-390,190)" fill="none" x1="0" x2="186" y1="0" y2="0" stroke="black"
      /><line transform="translate(-390,190)" fill="none" x1="186" x2="199" y1="0" y2="14" stroke="black"
      /><line transform="translate(-390,190)" fill="none" x1="199" x2="199" y1="14" y2="79" stroke="black"
      /><line transform="translate(-390,190)" fill="none" x1="199" x2="0" y1="79" y2="79" stroke="black"
      /><line transform="translate(-390,190)" fill="none" x1="0" x2="0" y1="79" y2="0" stroke="black"
      /><line transform="translate(-390,190)" fill="none" x1="186" x2="186" y1="0" y2="14" stroke="black"
      /><line transform="translate(-390,190)" fill="none" x1="186" x2="199" y1="14" y2="14" stroke="black"
    /></g
    ><g stroke-dasharray="8,5" font-size="14" stroke-miterlimit="5" font-family="sans-serif" transform="translate(80,70)" stroke-linecap="butt"
    ><line y2="75" fill="none" x1="30" x2="30" y1="30"
      /><line y2="120" fill="none" x1="30" x2="30" y1="75"
      /><line stroke-linecap="square" fill="none" x1="30" x2="36" y1="30" y2="42" stroke-dasharray="none" stroke-miterlimit="10"
      /><line stroke-linecap="square" fill="none" x1="30" x2="24" y1="30" y2="42" stroke-dasharray="none" stroke-miterlimit="10"
    /></g
    ><g fill="blue" font-size="14" font-family="sans-serif" transform="translate(70,310)" stroke="blue"
    ><polygon opacity="0.5" points=" 0 0 176 0 176 0 189 14 189 14 189 109 189 109 0 109 0 109 0 0" stroke="none"
      /><text fill="black" x="7" xml:space="preserve" y="17" stroke="none"
      >The singleton instance</text
      ><text fill="black" x="7" xml:space="preserve" y="34" stroke="none"
      >has a well-known name</text
      ><text fill="black" x="7" xml:space="preserve" y="51" stroke="none"
      >on which begin() etc can</text
      ><text fill="black" x="7" xml:space="preserve" y="68" stroke="none"
      >be called. This is how</text
      ><text fill="black" x="7" xml:space="preserve" y="85" stroke="none"
      >Serial behaves in the</text
      ><text fill="black" x="7" xml:space="preserve" y="102" stroke="none"
      >standard library</text
      ><line y2="0" fill="none" x1="0" x2="176" stroke="black" y1="0"
      /><line y2="14" fill="none" x1="176" x2="189" stroke="black" y1="0"
      /><line y2="109" fill="none" x1="189" x2="189" stroke="black" y1="14"
      /><line y2="109" fill="none" x1="189" x2="0" stroke="black" y1="109"
      /><line y2="0" fill="none" x1="0" x2="0" stroke="black" y1="109"
      /><line y2="14" fill="none" x1="176" x2="176" stroke="black" y1="0"
      /><line y2="14" fill="none" x1="176" x2="189" stroke="black" y1="14"
    /></g
    ><g stroke-dasharray="8,5" font-size="14" stroke-miterlimit="5" font-family="sans-serif" transform="translate(160,150)" stroke-linecap="butt"
    ><line y2="95" fill="none" x1="230" x2="130" y1="30"
      /><line y2="160" fill="none" x1="130" x2="30" y1="95"
      /><line stroke-linecap="square" fill="none" x1="229" x2="222" y1="30" y2="42" stroke-dasharray="none" stroke-miterlimit="10"
      /><line stroke-linecap="square" fill="none" x1="229" x2="216" y1="30" y2="31" stroke-dasharray="none" stroke-miterlimit="10"
    /></g
    ><g fill="white" font-size="14" font-family="sans-serif" transform="translate(380,620)" stroke="white"
    ><rect x="0" width="279" height="149" y="0" opacity="0" stroke="none"
      /><rect fill="none" x="0" width="279" height="149" y="0" stroke="black"
      /><text fill="black" x="87" xml:space="preserve" y="17" stroke="none"
      >RepeatingActor</text
      ><line y2="20" fill="none" x1="0" x2="279" stroke="black" y1="20"
      /><text fill="black" x="7" xml:space="preserve" y="37" stroke="none"
      >-actor : Actor</text
      ><text fill="black" x="7" xml:space="preserve" y="54" stroke="none"
      >-period : long</text
      ><line y2="57" fill="none" x1="0" x2="279" stroke="black" y1="57"
      /><text fill="black" x="7" xml:space="preserve" y="74" stroke="none"
      >RepeatingACtor( a : Actor, p : long )</text
      ><text fill="black" x="7" xml:space="preserve" y="91" stroke="none"
      >pre()</text
      ><text fill="black" x="7" xml:space="preserve" y="108" stroke="none"
      >behaviour()</text
      ><line y2="111" fill="none" x1="0" x2="279" stroke="black" y1="111"
      /><text fill="black" x="7" xml:space="preserve" y="128" stroke="none"
      >Responsibilities</text
      ><text fill="black" x="7" xml:space="preserve" y="145" stroke="none"
      >-- Run an underlying actor periodically</text
      ><line transform="translate(110,-120)" fill="none" x1="30" x2="30" y1="30" y2="75" stroke="black"
      /><line transform="translate(110,-120)" fill="none" x1="30" x2="30" y1="75" y2="120" stroke="black"
      /><line transform="translate(110,-120)" fill="none" x1="30" x2="36" y1="30" y2="42" stroke="black"
      /><line transform="translate(110,-120)" fill="none" x1="30" x2="24" y1="30" y2="42" stroke="black"
      /><polygon points=" 30 30 36 42 24 42" transform="translate(110,-120)" stroke="none"
      /><polygon fill="none" transform="translate(110,-120)" points=" 30 30 36 42 24 42" stroke="black"
    /></g
  ></g
></svg
>
